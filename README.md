# BeholderBot (Python 3.11)

**Beholder Bot** (Бот-Наблюдатель) - сервис-расширение платформы Telegram представленный для людей Telegram в виде бота.

**Ценность** - улучшение качества жизни человека путем предоставления ретроспективной информации о настроении человека,
на основе которой человек будет принимать решения, повышающие его уровень жизни.

**Способ измерения ценности** - количество активных клиентов приложения. Чем их больше, тем большая ценность предоставляется.

## Глоссарий

- **Телеграм** (Telegram) - платформа для общения между людьми.
- **Пользователь** (User) - реальный человек, использующий Телеграм для взаимодействия с ботом.
- **Бот** (Bot) - разрабатываемое приложение взаимодействующее с пользователем для сбора и анализа статистики.
- **День** (day) - единица измерения жизни пользователя, состоящая из статуса дня и даты.
- **Статус дня** (Day status) - эмоциональная оценка пользователем одного из своих дней: хороший, нормальный, плохой.
- **График** (Graph) - визуальное представление всех сохраненных статусов дней для пользователя.
- **Время напоминания** (Day Reminder Time) - время с учетом часового пояса пользователя,
  - если пользователь до этого времени не сохранил статус дня, то необходимо запросить у пользователя состояние дня.

## Use cases

- Пользователь добавляет бота и устанавливает время напоминания о статусе дня.
- Пользователь сохраняет статус дня в боте.
- Пользователь запрашивает график по всем сохраненным дням у бота.

- Бот, в установленное время напоминания, проверяет, был ли сохранен статус текущего дня
  - если статус текущего дня не сохранен, то бот запрашивает статус дня у пользователя
    - если пользователь отправляет статус дня,
      - то бот сохраняет статус дня
    - если пользователь не отправляет статус дня, 
      - то бот, перед следующим напоминанием, не сохраняет статус прошлого дня и отменяет прошлый запрос статуса дня

## Ограничения и допущения
- в первой версии бот будет использоваться одним человеком (alpha);
- вторая версия должна поддерживать N пользователей, где N <= 10 (beta);
- третья версия должна иметь расширенную функциональность и поддерживать N пользователей, где N <= 100 (release).

## Bot API 

Даты и статусы:
- `/day_good`
- `/day_norm`
- `/day_bad`
  - добавить статус в текущий день

Статистика и графики:
- `/graph`
  - получить картинку с графиком за все время

## Install linux

Тестировалось на python 3.10 и 3.11

1. Склонировать репозиторий в рабочую директорию бота
2. Создать виртуальное окружение:
   - `python3 -m venv /path/to/bot/venv`
   - `source /path/to/bot/venv/bin/acivate`
   - `python3 -m pip install -r /path/to/bot/requirments.txt`
   - `deactivate`
2. Перейти в `/etc/systemd/system/`
3. Создать файл `beholder_bot.service`
4. В файле прописать:
```
[Unit]
Description=Beholder Bot Python
After=network.target

[Service]
ExecStart=/bin/bash -c 'source /path/to/bot/venv/bin/activate && python3 /path/to/bot/main.py'
WorkingDirectory=/path/to/bot
Restart=always
User=root
Environment="BOT_TOKEN=<>"
Environment="BOT_CHAT_ID=<>"
Environment="BOT_REMINDER_DAY_TIME=23:00"
Environment="BOT_DATA_PATH=/home/data"

[Install]
WantedBy=multi-user.target
```
6. Сохранить и закрыть файл.
7. Обновить конфигурацию служб:
   - `sudo systemctl daemon-reload`
8. Перезапустить службу:
   - `sudo systemctl restart beholder_bot.service`

## Sequence diagram

![sequence.png](/diagrams/sequence.png)
